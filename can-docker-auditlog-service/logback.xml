<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <appender name="stdout" class="ch.qos.logback.core.ConsoleAppender">
    <encoder>
      <Pattern>java_timestamp=%d{"yyyy-MM-dd'T'HH:mm:ss,SSS"} thread=%thread level=%-5level class=%logger{36} line=%L x-amz-cf-id=%X{x-amz-cf-id} x-amzn-trace-id=%X{x-amzn-trace-id} request_id=%X{requestId} remote_host=%X{remoteHost:-no_remote_host} account_id=%X{accountId:-no_account} project_id=%X{projectId:-no_project} %msg%n</Pattern>
    </encoder>
  </appender>
  <appender name="kinesis" class="com.cleveranalytics.common.libs.aws.logback.KinesisAppenderWebIdentityTokenCredentialsProvider">
    <filter class="com.cleveranalytics.common.logging.AuditLogLogbackFilter"/>
    <bufferSize>1000</bufferSize>
    <threadCount>1</threadCount>
    <region>eu-west-1</region>
    <maxRetries>3</maxRetries>
    <shutdownTimeout>30</shutdownTimeout>
    <streamName>staging_audit_log</streamName>
    <encoding>UTF-8</encoding>
    <layout class="ch.qos.logback.classic.PatternLayout">
      <pattern>java_timestamp=%d{"yyyy-MM-dd'T'HH:mm:ss,SSS"} environment={{ .Values.environment }} request_id=%X{requestId:-no_request_id} remote_host=%X{remoteHost:-no_remote_host} account_id=%X{accountId:-no_account} project_id=%X{projectId:-no_project} %msg%n</pattern>
    </layout>
  </appender>
  <logger name="com.cleveranalytics" level="DEBUG"/>
  <root level="info">
    <appender-ref ref="stdout"/>
    <appender-ref ref="kinesis"/>
  </root>
</configuration>